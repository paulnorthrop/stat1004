<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Chapter 2: Graphs (More Than One Variable) • stat1004</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/paper/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Chapter 2: Graphs (More Than One Variable)">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">stat1004</a>
        <span class="version label label-danger" data-toggle="tooltip" data-placement="bottom" title="Unreleased version">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/stat1004-ch1a-shuttle-vignette.html">Chapter 1: The Challenger Space Shuttle Disaster</a>
    </li>
    <li>
      <a href="../articles/stat1004-ch1b-stochastic-simulation-vignette.html">Chapter 1: Stochastic Simulation</a>
    </li>
    <li>
      <a href="../articles/stat1004-ch2a-descriptive-statistics-vignette.html">Chapter 2: Descriptive Statistics</a>
    </li>
    <li>
      <a href="../articles/stat1004-ch2b-graphs-vignette.html">Chapter 2: Graphs (One Variable)</a>
    </li>
    <li>
      <a href="../articles/stat1004-ch2c-graphs-vignette.html">Chapter 2: Graphs (More Than One Variable)</a>
    </li>
    <li>
      <a href="../articles/stat1004-ch2d-box-cox-transformation-vignette.html">Chapter 2: Transformation Of Variable</a>
    </li>
    <li>
      <a href="../articles/stat1004-ch5a-discrete-random-variables-vignette.html">Chapter 5: binomial, geometric and Poisson distributions</a>
    </li>
    <li>
      <a href="../articles/stat1004-ch5b-continous-random-variables-vignette.html">Chapter 5: uniform, exponential and normal distributions</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/paulnorthrop/stat1004">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Chapter 2: Graphs (More Than One Variable)</h1>
                        <h4 class="author">Paul Northrop</h4>
            
            <h4 class="date">2019-11-14</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/paulnorthrop/stat1004/blob/master/vignettes/stat1004-ch2c-graphs-vignette.Rmd"><code>vignettes/stat1004-ch2c-graphs-vignette.Rmd</code></a></small>
      <div class="hidden name"><code>stat1004-ch2c-graphs-vignette.Rmd</code></div>

    </div>

    
    
<p>The main purpose of this vignette is to provide R code to produce graphs that involve more than one variable. We consider two general situations: (i) plotting the values of a continuous variable for different values of a categorical variable (see <a href="#the-oxford-birth-times-data">The Oxford Birth Times data</a>) and (ii) scatter plots of one variable against another (see <a href="#the-2000-us-presidential-election-data">The 2000 US Presidential Election data</a>). The latter feature in Section 2.6 of the <a href="https://moodle.ucl.ac.uk/course/view.php?id=8579&amp;section=3">STAT0002 notes</a>. See also the <a href="stat1004-ch2b-graphs-vignette.html">Chapter 2: Graphs (one variable)</a>.</p>
<p>The R code used in this vignette are available: <a href="stat1004-ch2b-graphs-2-vignette.R">graphs-2-vignette.R</a>.</p>
<div id="the-oxford-birth-times-data" class="section level2">
<h2 class="hasAnchor">
<a href="#the-oxford-birth-times-data" class="anchor"></a>The Oxford Birth Times data</h2>
<p>These data are available in the data frame <code>ox_births</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="op">&gt;</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(stat1004)
<span class="op">&gt;</span><span class="st"> </span>birth_times &lt;-<span class="st"> </span>ox_births[, <span class="st">"time"</span>]
<span class="op">&gt;</span><span class="st"> </span>day &lt;-<span class="st"> </span>ox_births[, <span class="st">"day"</span>]</code></pre></div>
<p>To display these data we manipulate them into a matrix that is of the same format as Table 2.1 in the notes. The number of birth times varies between days so we pad the matrix with R’s missing values code <code>NA</code> in order that each column of the matrix has the same number of rows.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="op">&gt;</span><span class="st"> </span>ox_mat &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="ot">NA</span>, <span class="dt">ncol =</span> <span class="dv">7</span>, <span class="dt">nrow =</span> <span class="dv">16</span>)
<span class="op">&gt;</span><span class="st"> </span><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">7</span>) {
<span class="op">+</span><span class="st">   </span>day_i_times &lt;-<span class="st"> </span>ox_births<span class="op">$</span>time[<span class="kw"><a href="https://rdrr.io/r/base/which.html">which</a></span>(ox_births<span class="op">$</span>day <span class="op">==</span><span class="st"> </span>i)]
<span class="op">+</span><span class="st">   </span>ox_mat[<span class="dv">1</span><span class="op">:</span><span class="kw"><a href="https://rdrr.io/r/base/length.html">length</a></span>(day_i_times), i] &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/sort.html">sort</a></span>(day_i_times)
<span class="op">+</span><span class="st">   </span><span class="kw"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(ox_mat) &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/paste.html">paste</a></span>(<span class="st">"day"</span>, <span class="dv">1</span><span class="op">:</span><span class="dv">7</span>, <span class="dt">sep =</span> <span class="st">""</span>)
<span class="op">+</span><span class="st"> </span>}  
<span class="op">&gt;</span><span class="st"> </span>ox_mat
       day1  day2  day3  day4  day5  day6  day7
 [<span class="dv">1</span>,]  <span class="fl">2.10</span>  <span class="fl">4.00</span>  <span class="fl">2.60</span>  <span class="fl">1.50</span>  <span class="fl">2.50</span>  <span class="fl">4.00</span>  <span class="fl">2.00</span>
 [<span class="dv">2</span>,]  <span class="fl">3.40</span>  <span class="fl">4.10</span>  <span class="fl">3.60</span>  <span class="fl">4.70</span>  <span class="fl">2.50</span>  <span class="fl">4.00</span>  <span class="fl">2.70</span>
 [<span class="dv">3</span>,]  <span class="fl">4.25</span>  <span class="fl">5.00</span>  <span class="fl">3.60</span>  <span class="fl">4.70</span>  <span class="fl">3.40</span>  <span class="fl">5.25</span>  <span class="fl">2.75</span>
 [<span class="dv">4</span>,]  <span class="fl">5.60</span>  <span class="fl">5.50</span>  <span class="fl">6.40</span>  <span class="fl">7.20</span>  <span class="fl">4.20</span>  <span class="fl">6.10</span>  <span class="fl">3.40</span>
 [<span class="dv">5</span>,]  <span class="fl">6.40</span>  <span class="fl">5.70</span>  <span class="fl">6.80</span>  <span class="fl">7.25</span>  <span class="fl">5.90</span>  <span class="fl">6.50</span>  <span class="fl">4.20</span>
 [<span class="dv">6</span>,]  <span class="fl">7.30</span>  <span class="fl">6.50</span>  <span class="fl">7.50</span>  <span class="fl">8.10</span>  <span class="fl">6.25</span>  <span class="fl">6.90</span>  <span class="fl">4.30</span>
 [<span class="dv">7</span>,]  <span class="fl">8.50</span>  <span class="fl">7.25</span>  <span class="fl">7.50</span>  <span class="fl">8.50</span>  <span class="fl">7.30</span>  <span class="fl">7.00</span>  <span class="fl">4.90</span>
 [<span class="dv">8</span>,]  <span class="fl">8.75</span>  <span class="fl">7.30</span>  <span class="fl">8.25</span>  <span class="fl">9.20</span>  <span class="fl">7.50</span>  <span class="fl">8.45</span>  <span class="fl">6.25</span>
 [<span class="dv">9</span>,]  <span class="fl">8.90</span>  <span class="fl">7.50</span>  <span class="fl">8.50</span>  <span class="fl">9.50</span>  <span class="fl">7.80</span>  <span class="fl">9.25</span>  <span class="fl">7.00</span>
[<span class="dv">10</span>,]  <span class="fl">9.50</span>  <span class="fl">8.20</span> <span class="fl">10.40</span> <span class="fl">10.70</span>  <span class="fl">8.30</span> <span class="fl">10.10</span>  <span class="fl">9.00</span>
[<span class="dv">11</span>,]  <span class="fl">9.75</span>  <span class="fl">8.50</span> <span class="fl">10.75</span> <span class="fl">11.50</span>  <span class="fl">8.30</span> <span class="fl">10.20</span>  <span class="fl">9.25</span>
[<span class="dv">12</span>,] <span class="fl">10.00</span>  <span class="fl">9.75</span> <span class="fl">14.25</span>    <span class="ot">NA</span> <span class="fl">10.25</span> <span class="fl">12.75</span> <span class="fl">10.70</span>
[<span class="dv">13</span>,] <span class="fl">10.40</span> <span class="fl">11.00</span> <span class="fl">14.50</span>    <span class="ot">NA</span> <span class="fl">12.90</span> <span class="fl">14.60</span>    <span class="ot">NA</span>
[<span class="dv">14</span>,] <span class="fl">10.40</span> <span class="fl">11.20</span>    <span class="ot">NA</span>    <span class="ot">NA</span> <span class="fl">14.30</span>    <span class="ot">NA</span>    <span class="ot">NA</span>
[<span class="dv">15</span>,] <span class="fl">16.00</span> <span class="fl">15.00</span>    <span class="ot">NA</span>    <span class="ot">NA</span>    <span class="ot">NA</span>    <span class="ot">NA</span>    <span class="ot">NA</span>
[<span class="dv">16</span>,] <span class="fl">19.00</span> <span class="fl">16.50</span>    <span class="ot">NA</span>    <span class="ot">NA</span>    <span class="ot">NA</span>    <span class="ot">NA</span>    <span class="ot">NA</span></code></pre></div>
<p>We have a numeric continuous variable, <code>birth_times</code>, and a categorical variable, <code>day</code>. The following code produces the graphs in the <a href="https://moodle.ucl.ac.uk/course/view.php?id=8579&amp;section=3">STAT0002 lecture slides</a> that contain a plot of birth_times for each day of the week.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="op">&gt;</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/graphics/par.html">par</a></span>(<span class="dt">mar =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">4</span>, <span class="dv">4</span>, <span class="fl">0.5</span>, <span class="dv">1</span>))
<span class="op">&gt;</span><span class="st"> </span>xlab &lt;-<span class="st"> "time (hours)"</span>
<span class="op">&gt;</span><span class="st"> </span>x_labs &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span>(birth_times), <span class="kw"><a href="https://rdrr.io/r/base/pretty.html">pretty</a></span>(birth_times), <span class="kw"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span>(birth_times))
<span class="op">&gt;</span><span class="st"> </span><span class="co"># top left</span>
<span class="er">&gt;</span><span class="st"> </span><span class="kw"><a href="../reference/box_plot.html">box_plot</a></span>(birth_times <span class="op">~</span><span class="st"> </span>day, <span class="dt">col =</span> <span class="dv">8</span>, <span class="dt">ylab =</span> xlab, <span class="dt">pch =</span> <span class="dv">16</span>, <span class="dt">xlab =</span> <span class="st">"day"</span>)
<span class="op">&gt;</span><span class="st"> </span><span class="co"># top right</span>
<span class="er">&gt;</span><span class="st"> </span><span class="kw"><a href="../reference/box_plot.html">box_plot</a></span>(birth_times <span class="op">~</span><span class="st"> </span>day, <span class="dt">col =</span> <span class="dv">8</span>, <span class="dt">horizontal =</span> <span class="ot">TRUE</span>,  <span class="dt">axes =</span> <span class="ot">FALSE</span>, <span class="dt">xlab =</span> xlab, <span class="dt">ylab =</span> <span class="st">"day"</span>, <span class="dt">pch =</span> <span class="dv">16</span>)
<span class="op">&gt;</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/graphics/axis.html">axis</a></span>(<span class="dv">1</span>, <span class="dt">at =</span> x_labs, <span class="dt">labels =</span> x_labs)
<span class="op">&gt;</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/graphics/axis.html">axis</a></span>(<span class="dv">2</span>, <span class="dt">at =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">7</span>, <span class="dt">labels =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">7</span>, <span class="dt">lwd =</span> <span class="dv">0</span>, <span class="dt">lty =</span> <span class="dv">0</span>)
<span class="op">&gt;</span><span class="st"> </span><span class="co"># bottom left</span>
<span class="er">&gt;</span><span class="st"> </span><span class="kw"><a href="../reference/box_plot.html">box_plot</a></span>(birth_times <span class="op">~</span><span class="st"> </span>day, <span class="dt">axes =</span> <span class="ot">FALSE</span>, <span class="dt">ylab =</span> xlab, <span class="dt">pch =</span> <span class="dv">16</span>, <span class="dt">lty =</span> <span class="dv">1</span>, <span class="dt">range =</span> <span class="dv">0</span>, <span class="dt">boxcol =</span> <span class="st">"white"</span>, <span class="dt">staplewex =</span> <span class="dv">0</span>, <span class="dt">medlty =</span> <span class="st">"blank"</span>, <span class="dt">medpch =</span> <span class="dv">16</span>, <span class="dt">xlab =</span> <span class="st">"day"</span>)
<span class="op">&gt;</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/graphics/axis.html">axis</a></span>(<span class="dv">1</span>, <span class="dt">at =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">7</span>, <span class="dt">labels =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">7</span>, <span class="dt">lwd =</span> <span class="dv">0</span>, <span class="dt">lty =</span> <span class="dv">0</span>)
<span class="op">&gt;</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/graphics/axis.html">axis</a></span>(<span class="dv">2</span>, <span class="dt">at =</span> x_labs, <span class="dt">labels =</span> x_labs)
<span class="op">&gt;</span><span class="st"> </span><span class="co"># bottom right</span>
<span class="er">&gt;</span><span class="st"> </span><span class="kw"><a href="../reference/box_plot.html">box_plot</a></span>(birth_times <span class="op">~</span><span class="st"> </span>day, <span class="dt">horizontal =</span> <span class="ot">TRUE</span>, <span class="dt">axes =</span> <span class="ot">FALSE</span>, <span class="dt">xlab =</span> xlab, <span class="dt">pch =</span> <span class="dv">16</span>, <span class="dt">lty =</span> <span class="dv">1</span>, <span class="dt">range =</span> <span class="dv">0</span>, <span class="dt">boxcol =</span> <span class="st">"white"</span>, <span class="dt">staplewex =</span> <span class="dv">0</span>, <span class="dt">medlty =</span> <span class="st">"blank"</span>, <span class="dt">medpch =</span> <span class="dv">16</span>)
<span class="op">&gt;</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/graphics/axis.html">axis</a></span>(<span class="dv">1</span>, <span class="dt">at =</span> x_labs, <span class="dt">labels =</span> x_labs)
<span class="op">&gt;</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/graphics/axis.html">axis</a></span>(<span class="dv">2</span>, <span class="dt">at =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">7</span>, <span class="dt">labels =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">7</span>, <span class="dt">lwd =</span> <span class="dv">0</span>, <span class="dt">lty =</span> <span class="dv">0</span>, <span class="dt">las =</span> <span class="dv">1</span>)</code></pre></div>
<p><img src="stat1004-ch2c-graphs-vignette_files/figure-html/unnamed-chunk-4-1.png" width="326.4"><img src="stat1004-ch2c-graphs-vignette_files/figure-html/unnamed-chunk-4-2.png" width="326.4"><img src="stat1004-ch2c-graphs-vignette_files/figure-html/unnamed-chunk-4-3.png" width="326.4"><img src="stat1004-ch2c-graphs-vignette_files/figure-html/unnamed-chunk-4-4.png" width="326.4"></p>
</div>
<div id="the-2000-us-presidential-election-in-florida" class="section level2">
<h2 class="hasAnchor">
<a href="#the-2000-us-presidential-election-in-florida" class="anchor"></a>The 2000 US Presidential Election in Florida</h2>
<p>These data are available in the data frame <code>USelection</code>. See <code><a href="../reference/USelection.html">?USelection</a></code> for details.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="op">&gt;</span><span class="st"> </span><span class="co"># County identifiers and location</span>
<span class="er">&gt;</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(USelection[, <span class="dv">1</span><span class="op">:</span><span class="dv">4</span>])
  co co_names  lat  lon
<span class="dv">1</span>  <span class="dv">1</span>  Alachua <span class="fl">29.7</span> <span class="fl">82.4</span>
<span class="dv">2</span>  <span class="dv">2</span>    Baker <span class="fl">30.3</span> <span class="fl">82.3</span>
<span class="dv">3</span>  <span class="dv">3</span>      Bay <span class="fl">30.2</span> <span class="fl">85.6</span>
<span class="dv">4</span>  <span class="dv">4</span> Bradford <span class="fl">29.9</span> <span class="fl">82.2</span>
<span class="dv">5</span>  <span class="dv">5</span>  Brevard <span class="fl">28.3</span> <span class="fl">80.7</span>
<span class="dv">6</span>  <span class="dv">6</span>  Broward <span class="fl">26.1</span> <span class="fl">80.5</span>
<span class="op">&gt;</span><span class="st"> </span><span class="co"># County demographic variables</span>
<span class="er">&gt;</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(USelection[, <span class="dv">5</span><span class="op">:</span><span class="dv">12</span>])
     npop whit blac hisp  o65 hsed coll  inco
<span class="dv">1</span>  <span class="dv">198326</span> <span class="fl">74.4</span> <span class="fl">21.8</span>  <span class="fl">4.7</span>  <span class="fl">9.4</span> <span class="fl">82.7</span> <span class="fl">34.6</span> <span class="dv">19412</span>
<span class="dv">2</span>   <span class="dv">20761</span> <span class="fl">82.4</span> <span class="fl">16.8</span>  <span class="fl">1.5</span>  <span class="fl">7.7</span> <span class="fl">64.1</span>  <span class="fl">5.7</span> <span class="dv">14859</span>
<span class="dv">3</span>  <span class="dv">146223</span> <span class="fl">84.2</span> <span class="fl">12.4</span>  <span class="fl">2.4</span> <span class="fl">11.9</span> <span class="fl">74.7</span> <span class="fl">15.7</span> <span class="dv">17838</span>
<span class="dv">4</span>   <span class="dv">24646</span> <span class="fl">76.1</span> <span class="fl">22.9</span>  <span class="fl">2.6</span> <span class="fl">11.8</span> <span class="fl">65.0</span>  <span class="fl">8.1</span> <span class="dv">13681</span>
<span class="dv">5</span>  <span class="dv">460977</span> <span class="fl">88.3</span>  <span class="fl">9.2</span>  <span class="fl">4.1</span> <span class="fl">16.5</span> <span class="fl">82.3</span> <span class="fl">20.4</span> <span class="dv">19567</span>
<span class="dv">6</span> <span class="dv">1470758</span> <span class="fl">80.3</span> <span class="fl">17.5</span> <span class="fl">10.9</span> <span class="fl">20.3</span> <span class="fl">76.8</span> <span class="fl">18.8</span> <span class="dv">24706</span>
<span class="op">&gt;</span><span class="st"> </span><span class="co"># Numbers of votes for candidates</span>
<span class="er">&gt;</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(USelection[, <span class="dv">13</span><span class="op">:</span><span class="dv">22</span>])
    bush   gore brow nade harr hage buch mcre phil moor
<span class="dv">1</span>  <span class="dv">34124</span>  <span class="dv">47365</span>  <span class="dv">658</span> <span class="dv">3226</span>    <span class="dv">6</span>   <span class="dv">42</span>  <span class="dv">263</span>    <span class="dv">4</span>   <span class="dv">20</span>   <span class="dv">21</span>
<span class="dv">2</span>   <span class="dv">5610</span>   <span class="dv">2392</span>   <span class="dv">17</span>   <span class="dv">53</span>    <span class="dv">0</span>    <span class="dv">3</span>   <span class="dv">73</span>    <span class="dv">0</span>    <span class="dv">3</span>    <span class="dv">3</span>
<span class="dv">3</span>  <span class="dv">38637</span>  <span class="dv">18850</span>  <span class="dv">171</span>  <span class="dv">828</span>    <span class="dv">5</span>   <span class="dv">18</span>  <span class="dv">248</span>    <span class="dv">3</span>   <span class="dv">18</span>   <span class="dv">27</span>
<span class="dv">4</span>   <span class="dv">5414</span>   <span class="dv">3075</span>   <span class="dv">28</span>   <span class="dv">84</span>    <span class="dv">0</span>    <span class="dv">2</span>   <span class="dv">65</span>    <span class="dv">0</span>    <span class="dv">2</span>    <span class="dv">3</span>
<span class="dv">5</span> <span class="dv">115185</span>  <span class="dv">97318</span>  <span class="dv">643</span> <span class="dv">4470</span>   <span class="dv">11</span>   <span class="dv">39</span>  <span class="dv">570</span>   <span class="dv">11</span>   <span class="dv">72</span>   <span class="dv">76</span>
<span class="dv">6</span> <span class="dv">177323</span> <span class="dv">386561</span> <span class="dv">1212</span> <span class="dv">7101</span>   <span class="dv">50</span>  <span class="dv">129</span>  <span class="dv">788</span>   <span class="dv">34</span>   <span class="dv">74</span>  <span class="dv">124</span></code></pre></div>
<p>For the moment we simply produce some scatter plots. A separate vignette will be devoted to these data.</p>
<p>A plot to show the locations of the counties.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="op">&gt;</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(<span class="op">-</span>USelection[, <span class="st">"lon"</span>], USelection[, <span class="st">"lat"</span>], <span class="dt">xlab =</span> <span class="st">"longitude (degrees north)"</span>, <span class="dt">ylab =</span> <span class="st">"latitude (degrees east)"</span>, <span class="dt">pch =</span> <span class="dv">16</span>)</code></pre></div>
<p><img src="stat1004-ch2c-graphs-vignette_files/figure-html/unnamed-chunk-6-1.png" width="576"></p>
<ol style="list-style-type: decimal">
<li><strong>Can you see the outline of the state of Florida?</strong></li>
</ol>
<p>A plot of the percentage of the vote for Buchanan against population size.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="op">&gt;</span><span class="st"> </span>pbuch &lt;-<span class="st"> </span><span class="dv">100</span> <span class="op">*</span><span class="st"> </span>USelection<span class="op">$</span>buch<span class="op">/</span>USelection<span class="op">$</span>tvot
<span class="op">&gt;</span><span class="st"> </span>is_PB &lt;-<span class="st"> </span>USelection[, <span class="st">"co_names"</span>] <span class="op">==</span><span class="st"> "PalmBeach"</span>
<span class="op">&gt;</span><span class="st"> </span>pch &lt;-<span class="st"> </span><span class="dv">1</span> <span class="op">+</span><span class="st"> </span><span class="dv">3</span> <span class="op">*</span><span class="st"> </span>is_PB
<span class="op">&gt;</span><span class="st"> </span>pch
 [<span class="dv">1</span>] <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span>
[<span class="dv">36</span>] <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">4</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span>
<span class="op">&gt;</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(USelection<span class="op">$</span>npop, pbuch, <span class="dt">xlab =</span> <span class="st">"population"</span>, <span class="dt">ylab =</span> <span class="st">"Buchanan % vote"</span>, <span class="dt">pch =</span> pch)
<span class="op">&gt;</span><span class="st"> </span>which_PB &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/which.html">which</a></span>(is_PB)
<span class="op">&gt;</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/graphics/text.html">text</a></span>(USelection[which_PB, <span class="st">"npop"</span>], pbuch[which_PB] <span class="op">+</span><span class="st"> </span><span class="fl">0.1</span>, <span class="st">"Palm Beach"</span>, <span class="dt">cex =</span> <span class="fl">0.8</span>)</code></pre></div>
<p><img src="stat1004-ch2c-graphs-vignette_files/figure-html/unnamed-chunk-7-1.png" width="576"></p>
<ol start="2" style="list-style-type: decimal">
<li><strong>Can you see how the code used to identify Palm Beach on the plot works?</strong></li>
</ol>
<p>Pairwise scatter plots of the demographic variables.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="op">&gt;</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/graphics/pairs.html">pairs</a></span>(USelection[, <span class="dv">5</span><span class="op">:</span><span class="dv">12</span>])</code></pre></div>
<p><img src="stat1004-ch2c-graphs-vignette_files/figure-html/unnamed-chunk-8-1.png" width="672"></p>
<p>A plot of the square root of the percentage of the vote for Buchanan against population size, in thousands of people. The horizontal axis has been plotted on a log scale.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="op">&gt;</span><span class="st"> </span>x &lt;-<span class="st"> </span>USelection<span class="op">$</span>npop <span class="op">/</span><span class="st"> </span><span class="dv">1000</span>
<span class="op">&gt;</span><span class="st"> </span>y &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span>(pbuch)
<span class="op">&gt;</span><span class="st"> </span>ystring &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/expression.html">expression</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span>(<span class="st">"% Buchanan vote"</span>))
<span class="op">&gt;</span><span class="st"> </span>rm_PB &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/which.html">which</a></span>(<span class="op">!</span>is_PB)
<span class="op">&gt;</span><span class="st"> </span><span class="kw"><a href="../reference/scatter.html">scatter</a></span>(x[rm_PB], y[rm_PB], <span class="dt">pch =</span> <span class="dv">16</span>, <span class="dt">xlab =</span><span class="st">"Total Population (1000s)"</span>, <span class="dt">ylab =</span> ystring, <span class="dt">log =</span> <span class="st">"x"</span>)
<span class="op">&gt;</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/graphics/points.html">points</a></span>(x[which_PB], y[which_PB], <span class="dt">pch =</span> <span class="st">"X"</span>)
<span class="op">&gt;</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/graphics/text.html">text</a></span>(x[which_PB], y[which_PB] <span class="op">+</span><span class="st"> </span><span class="fl">0.04</span>, <span class="st">"Palm Beach"</span>, <span class="dt">cex =</span> <span class="fl">0.8</span>)</code></pre></div>
<p><img src="stat1004-ch2c-graphs-vignette_files/figure-html/unnamed-chunk-9-1.png" width="672"></p>
<ol start="3" style="list-style-type: decimal">
<li><p><strong>Can you see how the different method to identify Palm Beach works?</strong></p></li>
<li><p><strong>Can you guess what the numbers on the axes are? See <code>scatter</code> to find out.</strong></p></li>
</ol>
<p>Similarly, we use <code>scatter_hist</code> to create a scatter plot in which the distribution of each variable is summarized by a histogram.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="op">&gt;</span><span class="st"> </span><span class="kw"><a href="../reference/scatter_hist.html">scatter_hist</a></span>(x, y, <span class="dt">log =</span> <span class="st">"x"</span>, <span class="dt">pch =</span> <span class="dv">16</span>, <span class="dt">xlab =</span><span class="st">"Total Population (1000s)"</span>, <span class="dt">ylab =</span> ystring)</code></pre></div>
<p><img src="stat1004-ch2c-graphs-vignette_files/figure-html/unnamed-chunk-10-1.png" width="576"></p>
<p>The plot in the lecture slides is produced by specifying particular bins for the histograms.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="op">&gt;</span><span class="st"> </span>logx &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/Log.html">log</a></span>(x)
<span class="op">&gt;</span><span class="st"> </span>xbreaks &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="dt">from =</span> <span class="kw"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span>(logx), <span class="dt">to =</span> <span class="kw"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span>(logx), <span class="dt">len =</span> <span class="dv">25</span>)
<span class="op">&gt;</span><span class="st"> </span>ybreaks &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="dt">from =</span> <span class="kw"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span>(y), <span class="dt">to =</span> <span class="kw"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span>(y), <span class="dt">len =</span> <span class="dv">25</span>)
<span class="op">&gt;</span><span class="st"> </span><span class="kw"><a href="../reference/scatter_hist.html">scatter_hist</a></span>(x, y, <span class="dt">log =</span> <span class="st">"x"</span>, <span class="dt">pch =</span> <span class="dv">16</span>, <span class="dt">xlab =</span><span class="st">"Total Population (1000s)"</span>, <span class="dt">ylab =</span> ystring, <span class="dt">xbreaks =</span> xbreaks, <span class="dt">ybreaks =</span> ybreaks)</code></pre></div>
<p><img src="stat1004-ch2c-graphs-vignette_files/figure-html/unnamed-chunk-11-1.png" width="576"></p>
<script type="text/x-mathjax-config">
   MathJax.Hub.Config({  "HTML-CSS": { minScaleAdjust: 125, availableFonts: [] }  });
</script>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#the-oxford-birth-times-data">The Oxford Birth Times data</a></li>
      <li><a href="#the-2000-us-presidential-election-in-florida">The 2000 US Presidential Election in Florida</a></li>
      </ul>
</div>
      </div>

</div>



      <footer><div class="copyright">
  <p>Developed by Paul J. Northrop.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
