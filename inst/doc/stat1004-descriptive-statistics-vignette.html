<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />

<meta name="viewport" content="width=device-width, initial-scale=1">

<meta name="author" content="Paul Northrop" />

<meta name="date" content="2017-04-17" />

<title>Chapter 2: Descriptive Statistics</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>



<link href="data:text/css;charset=utf-8,body%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Amargin%3A%201em%20auto%3B%0Amax%2Dwidth%3A%20700px%3B%0Aoverflow%3A%20visible%3B%0Apadding%2Dleft%3A%202em%3B%0Apadding%2Dright%3A%202em%3B%0Afont%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2014px%3B%0Aline%2Dheight%3A%201%2E35%3B%0A%7D%0A%23header%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0A%23TOC%20%7B%0Aclear%3A%20both%3B%0Amargin%3A%200%200%2010px%2010px%3B%0Apadding%3A%204px%3B%0Awidth%3A%20400px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Aborder%2Dradius%3A%205px%3B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Afont%2Dsize%3A%2013px%3B%0Aline%2Dheight%3A%201%2E3%3B%0A%7D%0A%23TOC%20%2Etoctitle%20%7B%0Afont%2Dweight%3A%20bold%3B%0Afont%2Dsize%3A%2015px%3B%0Amargin%2Dleft%3A%205px%3B%0A%7D%0A%23TOC%20ul%20%7B%0Apadding%2Dleft%3A%2040px%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%205px%3B%0A%7D%0A%23TOC%20ul%20ul%20%7B%0Amargin%2Dleft%3A%20%2D2em%3B%0A%7D%0A%23TOC%20li%20%7B%0Aline%2Dheight%3A%2016px%3B%0A%7D%0Atable%20%7B%0Amargin%3A%201em%20auto%3B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dcolor%3A%20%23DDDDDD%3B%0Aborder%2Dstyle%3A%20outset%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Aborder%2Dwidth%3A%202px%3B%0Apadding%3A%205px%3B%0Aborder%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dstyle%3A%20inset%3B%0Aline%2Dheight%3A%2018px%3B%0Apadding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0Aborder%2Dleft%2Dstyle%3A%20none%3B%0Aborder%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Ap%20%7B%0Amargin%3A%200%2E5em%200%3B%0A%7D%0Ablockquote%20%7B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Apadding%3A%200%2E25em%200%2E75em%3B%0A%7D%0Ahr%20%7B%0Aborder%2Dstyle%3A%20solid%3B%0Aborder%3A%20none%3B%0Aborder%2Dtop%3A%201px%20solid%20%23777%3B%0Amargin%3A%2028px%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Adl%20dd%20%7B%0Amargin%2Dbottom%3A%2013px%3B%0Amargin%2Dleft%3A%2013px%3B%0A%7D%0Adl%20dt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aul%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Aul%20li%20%7B%0Alist%2Dstyle%3A%20circle%20outside%3B%0A%7D%0Aul%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Apre%2C%20code%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0Acolor%3A%20%23333%3B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%20%0A%7D%0Apre%20%7B%0Aborder%2Dradius%3A%203px%3B%0Amargin%3A%205px%200px%2010px%200px%3B%0Apadding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0Apadding%3A%202px%200px%3B%0A%7D%0Adiv%2Efigure%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF%3B%0Apadding%3A%202px%3B%0Aborder%3A%201px%20solid%20%23DDDDDD%3B%0Aborder%2Dradius%3A%203px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Amargin%3A%200%205px%3B%0A%7D%0Ah1%20%7B%0Amargin%2Dtop%3A%200%3B%0Afont%2Dsize%3A%2035px%3B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah2%20%7B%0Aborder%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Apadding%2Dbottom%3A%202px%3B%0Afont%2Dsize%3A%20145%25%3B%0A%7D%0Ah3%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Afont%2Dsize%3A%20120%25%3B%0A%7D%0Ah4%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0Amargin%2Dleft%3A%208px%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Ah5%2C%20h6%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230033dd%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%236666ff%3B%20%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%23800080%3B%20%7D%0Aa%3Avisited%3Ahover%20%7B%0Acolor%3A%20%23BB00BB%3B%20%7D%0Aa%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0Aa%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%20code%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%0A" rel="stylesheet" type="text/css" />

</head>

<body>




<h1 class="title toc-ignore">Chapter 2: Descriptive Statistics</h1>
<h4 class="author"><em>Paul Northrop</em></h4>
<h4 class="date"><em>2017-04-17</em></h4>


<div id="TOC">
<ul>
<li><a href="#the-oxford-birth-times-data">The Oxford Birth Times data</a></li>
<li><a href="#five-number-summary">Five number summary</a></li>
<li><a href="#sample-mean">Sample mean</a></li>
<li><a href="#sample-standard-deviation-and-variance">Sample standard deviation and variance</a></li>
<li><a href="#measures-of-skewness">Measures of skewness</a></li>
</ul>
</div>

<p>The main purpose of this vignette is to provide R code to calculate the summary statistics that feature in Section 2.3 of the <a href="https://moodle.ucl.ac.uk/pluginfile.php/3054127/mod_resource/content/22/STAT1004notes-2x1.pdf">STAT1004 notes</a> (apart from correlation, which we defer until Chapter 9). An important point to appreciate is that usually there is more than one way to estimate from data a particular theoretical property of the distribution from which the data came. For example, we will see that there are many different rules (<em>estimators</em>) that can be used to estimate a quantile of a distribution.</p>
<div id="the-oxford-birth-times-data" class="section level2">
<h2>The Oxford Birth Times data</h2>
<p>These data are available in the data frame <code>ox_births</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(stat1004)
?ox_births</code></pre></div>
<p>We manipulate the data into a matrix that is of the same format as Table 2.1 in the notes. The number of birth times varies between days so we pad the matrix with R’s missing values code <code>NA</code> in order that each column of the matrix has the same number of rows.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">ox_mat &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="ot">NA</span>, <span class="dt">ncol =</span> <span class="dv">7</span>, <span class="dt">nrow =</span> <span class="dv">16</span>)
for (i in <span class="dv">1</span>:<span class="dv">7</span>) {
  day_i_times &lt;-<span class="st"> </span>ox_births$time[<span class="kw">which</span>(ox_births$day ==<span class="st"> </span>i)]
  ox_mat[<span class="dv">1</span>:<span class="kw">length</span>(day_i_times), i] &lt;-<span class="st"> </span><span class="kw">sort</span>(day_i_times)
  <span class="kw">colnames</span>(ox_mat) &lt;-<span class="st"> </span><span class="kw">paste</span>(<span class="st">&quot;day&quot;</span>, <span class="dv">1</span>:<span class="dv">7</span>, <span class="dt">sep =</span> <span class="st">&quot;&quot;</span>)
}  
ox_mat
<span class="co">#&gt;        day1  day2  day3  day4  day5  day6  day7</span>
<span class="co">#&gt;  [1,]  2.10  4.00  2.60  1.50  2.50  4.00  2.00</span>
<span class="co">#&gt;  [2,]  3.40  4.10  3.60  4.70  2.50  4.00  2.70</span>
<span class="co">#&gt;  [3,]  4.25  5.00  3.60  4.70  3.40  5.25  2.75</span>
<span class="co">#&gt;  [4,]  5.60  5.50  6.40  7.20  4.20  6.10  3.40</span>
<span class="co">#&gt;  [5,]  6.40  5.70  6.80  7.25  5.90  6.50  4.20</span>
<span class="co">#&gt;  [6,]  7.30  6.50  7.50  8.10  6.25  6.90  4.30</span>
<span class="co">#&gt;  [7,]  8.50  7.25  7.50  8.50  7.30  7.00  4.90</span>
<span class="co">#&gt;  [8,]  8.75  7.30  8.25  9.20  7.50  8.45  6.25</span>
<span class="co">#&gt;  [9,]  8.90  7.50  8.50  9.50  7.80  9.25  7.00</span>
<span class="co">#&gt; [10,]  9.50  8.20 10.40 10.70  8.30 10.10  9.00</span>
<span class="co">#&gt; [11,]  9.75  8.50 10.75 11.50  8.30 10.20  9.25</span>
<span class="co">#&gt; [12,] 10.00  9.75 14.25    NA 10.25 12.75 10.70</span>
<span class="co">#&gt; [13,] 10.40 11.00 14.50    NA 12.90 14.60    NA</span>
<span class="co">#&gt; [14,] 10.40 11.20    NA    NA 14.30    NA    NA</span>
<span class="co">#&gt; [15,] 16.00 15.00    NA    NA    NA    NA    NA</span>
<span class="co">#&gt; [16,] 19.00 16.50    NA    NA    NA    NA    NA</span></code></pre></div>
<p>We return to this matrix later. Until then we calculate summary statistics of the birth times data from all days of the week.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">birth_times &lt;-<span class="st"> </span>ox_births[, <span class="st">&quot;time&quot;</span>]
<span class="kw">sort</span>(birth_times)
<span class="co">#&gt;  [1]  1.50  2.00  2.10  2.50  2.50  2.60  2.70  2.75  3.40  3.40  3.40</span>
<span class="co">#&gt; [12]  3.60  3.60  4.00  4.00  4.00  4.10  4.20  4.20  4.25  4.30  4.70</span>
<span class="co">#&gt; [23]  4.70  4.90  5.00  5.25  5.50  5.60  5.70  5.90  6.10  6.25  6.25</span>
<span class="co">#&gt; [34]  6.40  6.40  6.50  6.50  6.80  6.90  7.00  7.00  7.20  7.25  7.25</span>
<span class="co">#&gt; [45]  7.30  7.30  7.30  7.50  7.50  7.50  7.50  7.80  8.10  8.20  8.25</span>
<span class="co">#&gt; [56]  8.30  8.30  8.45  8.50  8.50  8.50  8.50  8.75  8.90  9.00  9.20</span>
<span class="co">#&gt; [67]  9.25  9.25  9.50  9.50  9.75  9.75 10.00 10.10 10.20 10.25 10.40</span>
<span class="co">#&gt; [78] 10.40 10.40 10.70 10.70 10.75 11.00 11.20 11.50 12.75 12.90 14.25</span>
<span class="co">#&gt; [89] 14.30 14.50 14.60 15.00 16.00 16.50 19.00</span></code></pre></div>
</div>
<div id="five-number-summary" class="section level2">
<h2>Five number summary</h2>
<p>The function <code>five_number</code> calculates the five number summary of data, using the particular method for estimating the lower quartile, median and upper quartile described in the STAT1004 notes.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">five_number</span>(birth_times)
<span class="co">#&gt;   min   25%   50%   75%   max </span>
<span class="co">#&gt;  1.50  4.90  7.50  9.75 19.00</span></code></pre></div>
<p>The <code>summary</code> function can also be used to calculate a five number summary.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(birth_times)
<span class="co">#&gt;    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. </span>
<span class="co">#&gt;   1.500   4.950   7.500   7.723   9.750  19.000</span></code></pre></div>
<ol style="list-style-type: decimal">
<li><strong>(If we ignore the fact that <code>summary</code> also calculates the sample mean) does <code>summary</code> produce the same values as <code>five_number</code>?</strong></li>
</ol>
<p>No, the estimates of the lower quartile differ. This is because the functions <code>summary</code> and <code>five_number</code> use different rules to estimate quantiles: <code>summary</code> calls <code>quantile</code> using <code>type = 7</code> whereas <code>five_number</code> uses <code>type = 6</code>. If we call <code>five_number</code> with <code>type = 7</code> we get the same numbers as <code>summary</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">five_number</span>(birth_times, <span class="dt">type =</span> <span class="dv">7</span>)
<span class="co">#&gt;   min   25%   50%   75%   max </span>
<span class="co">#&gt;  1.50  4.95  7.50  9.75 19.00</span></code></pre></div>
<p>In fact the function <code>quantile</code> has 9 different options for <code>type</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">?quantile</code></pre></div>
</div>
<div id="sample-mean" class="section level2">
<h2>Sample mean</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">mean</span>(birth_times)
<span class="co">#&gt; [1] 7.723158</span></code></pre></div>
</div>
<div id="sample-standard-deviation-and-variance" class="section level2">
<h2>Sample standard deviation and variance</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">sd</span>(birth_times)
<span class="co">#&gt; [1] 3.568097</span>
<span class="kw">var</span>(birth_times)
<span class="co">#&gt; [1] 12.73132</span>
<span class="kw">sd</span>(birth_times) ^<span class="st"> </span><span class="dv">2</span>
<span class="co">#&gt; [1] 12.73132</span></code></pre></div>
</div>
<div id="measures-of-skewness" class="section level2">
<h2>Measures of skewness</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Standardized sample skewness</span>
<span class="kw">skew</span>(birth_times)
<span class="co">#&gt; [1] 0.6254774</span>
<span class="co"># Sample quartile skewness</span>
<span class="kw">q_skew</span>(birth_times)
<span class="co">#&gt; [1] -0.07216495</span></code></pre></div>
<p>[Until 2017/18 the STAT1004 notes gave -0.063 as the sample quartile skewness. This was because I used the default setting, type = 7, in the <code>quantile</code> function when calculating it …]</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">q_skew</span>(birth_times, <span class="dt">type =</span> <span class="dv">7</span>)
<span class="co">#&gt; [1] -0.0625</span></code></pre></div>
</div>



<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
